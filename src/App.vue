<template>
	<div id="app">
		<NavMenu class="app-fixed" :navPage="navPage" :portal="true" @goTo="loadPage"></NavMenu>
		<transition name="fade" mode="out-in">
			<component 
				:is="navPage" 
				@goTo="loadPage"
			></component>
		</transition>
		<Footer class="app-fixed" :portal="true"></Footer>
	</div>
</template>

<script>
import NavMenu from './components/NavMenu.vue'
import Footer from './components/Footer.vue'
import About from './components/About.vue'
import Home from './components/Home.vue'
import Catalogue from './components/Catalogue.vue'
import Training from './components/Training.vue'
import Demonstrators from './components/Demonstrators.vue'

const appPages = ['Home', 'About', 'Catalogue', 'Training', 'Demonstrators']

export default {
	name: 'App',
	components: {
		NavMenu,
		Footer,
		About,
		Home,
		Catalogue,
		Training,
		Demonstrators
	},
	data() {
		return {
			navPage: 'Home' 
		}
	},
	watch: {
		navPage() {
			if (typeof window.scrollTo == 'function') {
				window.scrollTo({ top: 0, behavior: 'smooth'})
			} else {
				window.scrollTop = 0
			}
		}
	},
	methods: {
		setPage() {
			const hash = location.hash.replace('#', '') || 'home'
			this.loadPage(hash)
		},
		loadPage(page) {
			// nicer to have hash part as all lowercase so this just needs to a page
			// argumet that could be a hash part in lowercase or a navPage in Propercase
			const properPage = page.substr(0, 1).toUpperCase() + page.substr(1).toLowerCase()
			if (appPages.includes(properPage)) {
				location.hash = page.toLowerCase()
				this.navPage = properPage
			}
		}
	},
	mounted() {
		this.setPage()
		window.addEventListener("hashchange", this.setPage)
	}
}
</script>

<style>
@import './assets/css/viewpoint-cssp.css';

#app {
	overflow-x: hidden;
}

.fade-enter-active,
.fade-leave-active {
	transition: all 0.3s ease-in-out;
}
.fade-enter,
.fade-leave-to {
	opacity: 0;
}
</style>
